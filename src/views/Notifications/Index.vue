<template>
  <div class="notifications-index">
    
    <section class="slice-xl page-title border-bottom has-bg-cover bg-size-cover" style="background-image: url(/assets/images/prv/shop/section-img-1.jpg);">
        <div class="container mask-container">
            <div class="row">
                <div class="col-md-6">
                    <!-- Fluid text paragraph -->
                    <div class="pb-4 mt-4">
                      <p class="lead">
                          Recent Notifications.
                      </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="slice sct-color-1">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-12 mt--150">
                    <form class="form-default" data-toggle="validator" role="form">
                        <div class="card">
                            <div class="card-body">
                                <table class="table-cart">
                                    <thead>
                                        <tr>
                                            <th class="product-image"></th>
                                            <th class="product-name">Product</th>
                                            <th class="product-size d-none d-lg-table-cell">Size</th>
                                            <th class="product-price d-none d-lg-table-cell">Price</th>
                                            <th class="product-quanity d-none d-md-table-cell">Quantity</th>
                                            <th class="product-total">Total</th>
                                            <th class="product-remove"></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="cart-item">
                                            <td class="product-image">
                                                <a href="#">
                                                    <img src="/assets/images/prv/shop/sportswear/img-1a.png">
                                                </a>
                                            </td>

                                            <td class="product-name">
                                                Nike running shoes - Pink
                                            </td>

                                            <td class="product-size product-size d-none d-lg-table-cell">
                                                <span class="strong-600">39</span>
                                            </td>

                                            <td class="product-price d-none d-lg-table-cell">
                                                $120 USD
                                            </td>

                                            <td class="product-quantity d-none d-md-table-cell">
                                                <div class="input-group input-group--style-2 pr-4" style="width: 130px;">
                                                    <span class="input-group-btn">
                                                        <button class="btn btn-number" type="button" data-type="minus" data-field="quantity[1]" disabled="disabled">
                                                            <i class="ion-minus"></i>
                                                        </button>
                                                    </span>
                                                    <input type="text" name="quantity[1]" class="form-control input-number" placeholder="3" value="1" min="1" max="10">
                                                    <span class="input-group-btn">
                                                        <button class="btn btn-number" type="button" data-type="plus" data-field="quantity[1]">
                                                             <i class="ion-plus"></i>
                                                        </button>
                                                    </span>
                                                </div>
                                            </td>
                                            <td class="product-total">
                                                <span>$120.00 USD</span>
                                            </td>
                                            <td class="product-remove">
                                                <a href="#" class="text-right pl-4">
                                                    <i class="ion-trash-a"></i>
                                                </a>
                                            </td>
                                        </tr>

                                        <!-- Cart item -->
                                        <tr class="cart-item">
                                            <td class="product-image">
                                                <a href="#">
                                                    <img src="/assets/images/prv/shop/sportswear/img-2a.png">
                                                </a>
                                            </td>

                                            <td class="product-name">
                                                Man short sleeve shirt - Pink
                                            </td>

                                            <td class="product-size product-size d-none d-lg-table-cell">
                                                <span class="strong-600">M</span>
                                            </td>

                                            <td class="product-price d-none d-lg-table-cell">
                                                $45 USD
                                            </td>

                                            <td class="product-quantity d-none d-md-table-cell">
                                                <div class="input-group input-group--style-2 pr-4" style="width: 130px;">
                                                    <span class="input-group-btn">
                                                        <button class="btn btn-number" type="button" data-type="minus" data-field="quantity[2]">
                                                            <i class="ion-minus"></i>
                                                        </button>
                                                    </span>
                                                    <input type="text" name="quantity[2]" class="form-control input-number" placeholder="3" value="2" min="1" max="10">
                                                    <span class="input-group-btn">
                                                        <button class="btn btn-number" type="button" data-type="plus" data-field="quantity[2]">
                                                             <i class="ion-plus"></i>
                                                        </button>
                                                    </span>
                                                </div>
                                            </td>
                                            <td class="product-total">
                                                <span>$90.00 USD</span>
                                            </td>
                                            <td class="product-remove">
                                                <a href="#" class="text-right pl-4">
                                                    <i class="ion-trash-a"></i>
                                                </a>
                                            </td>
                                        </tr>

                                        <!-- Cart item -->
                                        <tr class="cart-item">
                                            <td class="product-image">
                                                <a href="#">
                                                    <img src="/assets/images/prv/shop/sportswear/img-3a.png">
                                                </a>
                                            </td>

                                            <td class="product-name">
                                                Man running shoes- Black
                                            </td>

                                            <td class="product-size product-size d-none d-lg-table-cell">
                                                <span class="strong-600">42</span>
                                            </td>

                                            <td class="product-price d-none d-lg-table-cell">
                                                $160 USD
                                            </td>

                                            <td class="product-quantity d-none d-md-table-cell">
                                                <div class="input-group input-group--style-2 pr-4" style="width: 130px;">
                                                    <span class="input-group-btn">
                                                        <button class="btn btn-number" type="button" data-type="minus" data-field="quantity[3]" disabled="disabled">
                                                            <i class="ion-minus"></i>
                                                        </button>
                                                    </span>
                                                    <input type="text" name="quantity[3]" class="form-control input-number" placeholder="3" value="1" min="1" max="10">
                                                    <span class="input-group-btn">
                                                        <button class="btn btn-number" type="button" data-type="plus" data-field="quantity[3]">
                                                             <i class="ion-plus"></i>
                                                        </button>
                                                    </span>
                                                </div>
                                            </td>
                                            <td class="product-total">
                                                <span>$160.00 USD</span>
                                            </td>
                                            <td class="product-remove">
                                                <a href="#" class="text-right pl-4">
                                                    <i class="ion-trash-a"></i>
                                                </a>
                                            </td>
                                        </tr>

                                        <!-- Cart item -->
                                        <tr class="cart-item">
                                            <td class="product-image">
                                                <a href="#">
                                                    <img src="/assets/images/prv/shop/sportswear/img-4a.png">
                                                </a>
                                            </td>

                                            <td class="product-name">
                                                Ocean blue fitness shirt
                                            </td>

                                            <td class="product-size product-size d-none d-lg-table-cell">
                                                <span class="strong-600">XL</span>
                                            </td>

                                            <td class="product-price d-none d-lg-table-cell">
                                                $30 USD
                                            </td>

                                            <td class="product-quantity d-none d-md-table-cell">
                                                <div class="input-group input-group--style-2 pr-4" style="width: 130px;">
                                                    <span class="input-group-btn">
                                                        <button class="btn btn-number" type="button" data-type="minus" data-field="quantity[4]">
                                                            <i class="ion-minus"></i>
                                                        </button>
                                                    </span>
                                                    <input type="text" name="quantity[4]" class="form-control input-number" placeholder="3" value="4" min="1" max="10">
                                                    <span class="input-group-btn">
                                                        <button class="btn btn-number" type="button" data-type="plus" data-field="quantity[4]">
                                                             <i class="ion-plus"></i>
                                                        </button>
                                                    </span>
                                                </div>
                                            </td>
                                            <td class="product-total">
                                                <span>$120.00 USD</span>
                                            </td>
                                            <td class="product-remove">
                                                <a href="#" class="text-right pl-4">
                                                    <i class="ion-trash-a"></i>
                                                </a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="row align-items-center pt-5">
                            <div class="col-6">
                                <a href="#" class="link link--style-3">
                                    <i class="ion-android-arrow-back"></i>
                                    Return to shop
                                </a>
                            </div>
                            <div class="col-6 text-right">
                                <button type="submit" class="btn btn-styled btn-base-1">Proceed to checkout</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <h1>{{ message }}</h1>

    <div v-for="notification in notifications">
      <h5>{{ newDate(notification.created) }}</h5>
      <h4>{{ notification.note }}</h4>
      <router-link v-bind:to="'/projects/' + notification.project.id">Related Project: {{ notification.project.title }} </router-link>
      <br>
      <button v-on:click="destroy(notification)">Destroy Notification</button>
      <hr>
    </div>
    

  </div>
</template>

<script>

import axios from "axios";
import moment from "moment";


export default {
  data: function() {
    return {
      message: 'Recent Notifications',
      notifications: [],
    };
  },
  created: function() {
    axios.get("/api/notifications").then(response => {
      this.notifications = response.data;
    });
  },
  methods: {
    newDate: function(date) {
      return moment(date).format('MMMM Do YYYY');
    },
    destroy: function(notification) {
      axios
        .delete("/api/notifications/" + notification.id)
        .then(response => {
          console.log("Success!", response.data);
          // this.$router.push("/notifications");
          var index = this.notifications.indexOf(notification);
          this.notifications.splice(index, 1);
        });
      }
    },
};
</script>